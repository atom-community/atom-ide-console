"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _observable = require("@atom-ide-community/nuclide-commons/observable");

var _UniversalDisposable = _interopRequireDefault(require("@atom-ide-community/nuclide-commons/UniversalDisposable"));

var React = _interopRequireWildcard(require("react"));

var _rxjsCompatUmdMin = require("rxjs-compat/bundles/rxjs-compat.umd.min.js");

var _FilterReminder = _interopRequireDefault(require("@atom-ide-community/nuclide-commons-ui/FilterReminder"));

var _OutputTable = _interopRequireDefault(require("./OutputTable"));

var _ConsoleHeader = _interopRequireDefault(require("./ConsoleHeader"));

var _InputArea = _interopRequireDefault(require("./InputArea"));

var _PromptButton = _interopRequireDefault(require("./PromptButton"));

var _NewMessagesNotification = _interopRequireDefault(require("./NewMessagesNotification"));

var _assert = _interopRequireDefault(require("assert"));

var _nullthrows = _interopRequireDefault(require("nullthrows"));

var _shallowequal = _interopRequireDefault(require("shallowequal"));

var _recordsChanged = _interopRequireDefault(require("../recordsChanged"));

var _StyleSheet = _interopRequireDefault(require("@atom-ide-community/nuclide-commons-ui/StyleSheet"));

function _getRequireWildcardCache() { if (typeof WeakMap !== "function") return null; var cache = new WeakMap(); _getRequireWildcardCache = function () { return cache; }; return cache; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } if (obj === null || typeof obj !== "object" && typeof obj !== "function") { return { default: obj }; } var cache = _getRequireWildcardCache(); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

// Maximum time (ms) for the console to try scrolling to the bottom.
const MAXIMUM_SCROLLING_TIME = 3000;
const DEFAULT_SCOPE_NAME = "text.plain";
let count = 0;

class ConsoleView extends React.Component {
  // Used when _scrollToBottom is called. The console optimizes message loading
  // so scrolling to the bottom once doesn't always scroll to the bottom since
  // more messages can be loaded after.
  constructor(props) {
    super(props);
    this._consoleScrollPaneEl = void 0;
    this._consoleHeaderComponent = void 0;
    this._disposables = void 0;
    this._executorScopeDisposables = void 0;
    this._isScrolledNearBottom = void 0;
    this._id = void 0;
    this._inputArea = void 0;
    this._continuouslyScrollToBottom = void 0;
    this._scrollingThrottle = void 0;
    this._outputTable = void 0;

    this._getExecutor = id => {
      return this.props.executors.get(id);
    };

    this._getProvider = id => {
      return this.props.getProvider(id);
    };

    this._executePrompt = code => {
      this.props.execute(code); // Makes the console to scroll to the bottom.

      this._isScrolledNearBottom = true;
    };

    this._handleScroll = (offsetHeight, scrollHeight, scrollTop) => {
      this._handleScrollEnd(offsetHeight, scrollHeight, scrollTop);
    };

    this._handleOutputTable = ref => {
      this._outputTable = ref;
    };

    this._scrollToBottom = () => {
      if (!this._outputTable) {
        return;
      }

      this._outputTable.scrollToBottom();

      this.setState({
        unseenMessages: false
      });
    };

    this._startScrollToBottom = () => {
      if (!this._continuouslyScrollToBottom) {
        this._continuouslyScrollToBottom = true;
        this._scrollingThrottle = _rxjsCompatUmdMin.Observable.timer(MAXIMUM_SCROLLING_TIME).subscribe(() => {
          this._stopScrollToBottom();
        });
      }

      this._scrollToBottom();
    };

    this._stopScrollToBottom = () => {
      this._continuouslyScrollToBottom = false;

      if (this._scrollingThrottle != null) {
        this._scrollingThrottle.unsubscribe();
      }
    };

    this._shouldScrollToBottom = () => {
      return this._isScrolledNearBottom || this._continuouslyScrollToBottom;
    };

    this.state = {
      unseenMessages: false,
      scopeName: DEFAULT_SCOPE_NAME
    };
    this._disposables = new _UniversalDisposable.default();
    this._executorScopeDisposables = new _UniversalDisposable.default();
    this._isScrolledNearBottom = true;
    this._continuouslyScrollToBottom = false;
    this._id = count++;
  }

  componentDidMount() {
    this._disposables.add( // Wait for `<OutputTable />` to render itself via react-virtualized before scrolling and
    // re-measuring; Otherwise, the scrolled location will be inaccurate, preventing the Console
    // from auto-scrolling.
    _observable.macrotask.subscribe(() => {
      this._startScrollToBottom();
    }), () => {
      if (this._scrollingThrottle != null) {
        this._scrollingThrottle.unsubscribe();
      }
    }, atom.commands.add("atom-workspace", {
      // eslint-disable-next-line nuclide-internal/atom-apis
      "atom-ide-console:focus-console-prompt": () => {
        if (this._inputArea != null) {
          this._inputArea.focus();
        }
      }
    }), atom.commands.add("atom-workspace", {
      // eslint-disable-next-line nuclide-internal/atom-apis
      "atom-ide-console:scroll-to-bottom": () => {
        this._scrollToBottom();
      }
    }), atom.commands.add((0, _nullthrows.default)(this._consoleScrollPaneEl), "atom-ide:filter", () => this._focusFilter()));
  }

  componentWillUnmount() {
    this._disposables.dispose();

    this._executorScopeDisposables.dispose();
  }

  componentDidUpdate(prevProps) {
    // If records are added while we're scrolled to the bottom (or very very close, at least),
    // automatically scroll.
    if (this._isScrolledNearBottom && (0, _recordsChanged.default)(prevProps.records, this.props.records)) {
      this._startScrollToBottom();
    }
  }

  _focusFilter() {
    if (this._consoleHeaderComponent != null) {
      this._consoleHeaderComponent.focusFilter();
    }
  }

  _renderPromptButton() {
    (0, _assert.default)(this.props.currentExecutor != null);
    const {
      currentExecutor
    } = this.props;
    const options = Array.from(this.props.executors.values()).map(executor => ({
      id: executor.id,
      label: executor.name
    }));
    return /*#__PURE__*/React.createElement(_PromptButton.default, {
      value: currentExecutor.id,
      onChange: this.props.selectExecutor,
      options: options,
      children: currentExecutor.name
    });
  }

  _isScrolledToBottom(offsetHeight, scrollHeight, scrollTop) {
    return scrollHeight - (offsetHeight + scrollTop) < 5;
  }

  UNSAFE_componentWillReceiveProps(nextProps) {
    // If the messages were cleared, hide the notification.
    if (nextProps.records.length === 0) {
      this._isScrolledNearBottom = true;
      this.setState({
        unseenMessages: false
      });
    } else if ( // If we receive new messages after we've scrolled away from the bottom, show the "new
    // messages" notification.
    !this._isScrolledNearBottom && (0, _recordsChanged.default)(this.props.records, nextProps.records)) {
      this.setState({
        unseenMessages: true
      });
    }

    this._executorScopeDisposables.dispose();

    this._executorScopeDisposables = new _UniversalDisposable.default();

    for (const executor of nextProps.executors.values()) {
      if (executor != null && executor.onDidChangeScopeName != null) {
        this._executorScopeDisposables.add(executor.onDidChangeScopeName(() => {
          const scopeName = executor.scopeName();
          this.setState({
            scopeName
          });
        }));
      }
    }
  }

  shouldComponentUpdate(nextProps, nextState) {
    return !(0, _shallowequal.default)(this.props, nextProps) || !(0, _shallowequal.default)(this.state, nextState);
  }

  render() {
    return /*#__PURE__*/React.createElement("div", {
      className: "console"
    }, /*#__PURE__*/React.createElement(_StyleSheet.default, {
      sourcePath: "console-font-style",
      priority: -1,
      css: `
            #console-font-size-${this._id} {
              font-size: ${this.props.fontSize}px;
            }
          `
    }), /*#__PURE__*/React.createElement(_ConsoleHeader.default, {
      clear: this.props.clearRecords,
      createPaste: this.props.createPaste,
      invalidFilterInput: this.props.invalidFilterInput,
      enableRegExpFilter: this.props.enableRegExpFilter,
      filterText: this.props.filterText,
      ref: component => this._consoleHeaderComponent = component,
      selectedSourceIds: this.props.selectedSourceIds,
      sources: this.props.sources,
      onFilterChange: this.props.updateFilter,
      onSelectedSourcesChange: this.props.selectSources,
      selectedSeverities: this.props.selectedSeverities,
      toggleSeverity: this.props.toggleSeverity
    }), /*#__PURE__*/React.createElement("div", {
      className: "console-body",
      id: "console-font-size-" + this._id
    }, /*#__PURE__*/React.createElement("div", {
      className: "console-scroll-pane-wrapper atom-ide-filterable",
      ref: el => this._consoleScrollPaneEl = el
    }, /*#__PURE__*/React.createElement(_FilterReminder.default, {
      noun: "message",
      nounPlural: "messages",
      filteredRecordCount: this.props.filteredRecordCount,
      onReset: this.props.resetAllFilters
    }), /*#__PURE__*/React.createElement(_OutputTable.default // $FlowFixMe(>=0.53.0) Flow suppress
    , {
      ref: this._handleOutputTable,
      records: this.props.records,
      showSourceLabels: this.props.selectedSourceIds.length > 1,
      fontSize: this.props.fontSize,
      getExecutor: this._getExecutor,
      getProvider: this._getProvider,
      onScroll: this._handleScroll,
      shouldScrollToBottom: this._shouldScrollToBottom
    }), /*#__PURE__*/React.createElement(_NewMessagesNotification.default, {
      visible: this.state.unseenMessages,
      onClick: this._startScrollToBottom
    })), this._renderPrompt()));
  }

  _getMultiLineTip() {
    const {
      currentExecutor
    } = this.props;

    if (currentExecutor == null) {
      return "";
    }

    const keyCombo = process.platform === "darwin" ? // Option + Enter on Mac
    "\u2325  + \u23CE" : // Shift + Enter on Windows and Linux.
    "Shift + Enter";
    return `Tip: ${keyCombo} to insert a newline`;
  }

  _renderPrompt() {
    const {
      currentExecutor
    } = this.props;

    if (currentExecutor == null) {
      return;
    }

    return /*#__PURE__*/React.createElement("div", {
      className: "console-prompt"
    }, this._renderPromptButton(), /*#__PURE__*/React.createElement(_InputArea.default, {
      ref: component => this._inputArea = component,
      scopeName: this.state.scopeName,
      fontSize: this.props.fontSize,
      onSubmit: this._executePrompt,
      history: this.props.history,
      watchEditor: this.props.watchEditor,
      placeholderText: this._getMultiLineTip()
    }));
  }

  _handleScrollEnd(offsetHeight, scrollHeight, scrollTop) {
    const isScrolledToBottom = this._isScrolledToBottom(offsetHeight, scrollHeight, scrollTop);

    this._isScrolledNearBottom = isScrolledToBottom;

    this._stopScrollToBottom();

    this.setState({
      // TODO: (wbinnssmith) T30771435 this setState depends on current state
      // and should use an updater function rather than an object
      // eslint-disable-next-line react/no-access-state-in-setstate
      unseenMessages: this.state.unseenMessages && !this._isScrolledNearBottom
    });
  }

}

exports.default = ConsoleView;
module.exports = exports.default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkNvbnNvbGVWaWV3LmpzIl0sIm5hbWVzIjpbIk1BWElNVU1fU0NST0xMSU5HX1RJTUUiLCJERUZBVUxUX1NDT1BFX05BTUUiLCJjb3VudCIsIkNvbnNvbGVWaWV3IiwiUmVhY3QiLCJDb21wb25lbnQiLCJjb25zdHJ1Y3RvciIsInByb3BzIiwiX2NvbnNvbGVTY3JvbGxQYW5lRWwiLCJfY29uc29sZUhlYWRlckNvbXBvbmVudCIsIl9kaXNwb3NhYmxlcyIsIl9leGVjdXRvclNjb3BlRGlzcG9zYWJsZXMiLCJfaXNTY3JvbGxlZE5lYXJCb3R0b20iLCJfaWQiLCJfaW5wdXRBcmVhIiwiX2NvbnRpbnVvdXNseVNjcm9sbFRvQm90dG9tIiwiX3Njcm9sbGluZ1Rocm90dGxlIiwiX291dHB1dFRhYmxlIiwiX2dldEV4ZWN1dG9yIiwiaWQiLCJleGVjdXRvcnMiLCJnZXQiLCJfZ2V0UHJvdmlkZXIiLCJnZXRQcm92aWRlciIsIl9leGVjdXRlUHJvbXB0IiwiY29kZSIsImV4ZWN1dGUiLCJfaGFuZGxlU2Nyb2xsIiwib2Zmc2V0SGVpZ2h0Iiwic2Nyb2xsSGVpZ2h0Iiwic2Nyb2xsVG9wIiwiX2hhbmRsZVNjcm9sbEVuZCIsIl9oYW5kbGVPdXRwdXRUYWJsZSIsInJlZiIsIl9zY3JvbGxUb0JvdHRvbSIsInNjcm9sbFRvQm90dG9tIiwic2V0U3RhdGUiLCJ1bnNlZW5NZXNzYWdlcyIsIl9zdGFydFNjcm9sbFRvQm90dG9tIiwiT2JzZXJ2YWJsZSIsInRpbWVyIiwic3Vic2NyaWJlIiwiX3N0b3BTY3JvbGxUb0JvdHRvbSIsInVuc3Vic2NyaWJlIiwiX3Nob3VsZFNjcm9sbFRvQm90dG9tIiwic3RhdGUiLCJzY29wZU5hbWUiLCJVbml2ZXJzYWxEaXNwb3NhYmxlIiwiY29tcG9uZW50RGlkTW91bnQiLCJhZGQiLCJtYWNyb3Rhc2siLCJhdG9tIiwiY29tbWFuZHMiLCJmb2N1cyIsIl9mb2N1c0ZpbHRlciIsImNvbXBvbmVudFdpbGxVbm1vdW50IiwiZGlzcG9zZSIsImNvbXBvbmVudERpZFVwZGF0ZSIsInByZXZQcm9wcyIsInJlY29yZHMiLCJmb2N1c0ZpbHRlciIsIl9yZW5kZXJQcm9tcHRCdXR0b24iLCJjdXJyZW50RXhlY3V0b3IiLCJvcHRpb25zIiwiQXJyYXkiLCJmcm9tIiwidmFsdWVzIiwibWFwIiwiZXhlY3V0b3IiLCJsYWJlbCIsIm5hbWUiLCJzZWxlY3RFeGVjdXRvciIsIl9pc1Njcm9sbGVkVG9Cb3R0b20iLCJVTlNBRkVfY29tcG9uZW50V2lsbFJlY2VpdmVQcm9wcyIsIm5leHRQcm9wcyIsImxlbmd0aCIsIm9uRGlkQ2hhbmdlU2NvcGVOYW1lIiwic2hvdWxkQ29tcG9uZW50VXBkYXRlIiwibmV4dFN0YXRlIiwicmVuZGVyIiwiZm9udFNpemUiLCJjbGVhclJlY29yZHMiLCJjcmVhdGVQYXN0ZSIsImludmFsaWRGaWx0ZXJJbnB1dCIsImVuYWJsZVJlZ0V4cEZpbHRlciIsImZpbHRlclRleHQiLCJjb21wb25lbnQiLCJzZWxlY3RlZFNvdXJjZUlkcyIsInNvdXJjZXMiLCJ1cGRhdGVGaWx0ZXIiLCJzZWxlY3RTb3VyY2VzIiwic2VsZWN0ZWRTZXZlcml0aWVzIiwidG9nZ2xlU2V2ZXJpdHkiLCJlbCIsImZpbHRlcmVkUmVjb3JkQ291bnQiLCJyZXNldEFsbEZpbHRlcnMiLCJfcmVuZGVyUHJvbXB0IiwiX2dldE11bHRpTGluZVRpcCIsImtleUNvbWJvIiwicHJvY2VzcyIsInBsYXRmb3JtIiwiaGlzdG9yeSIsIndhdGNoRWRpdG9yIiwiaXNTY3JvbGxlZFRvQm90dG9tIl0sIm1hcHBpbmdzIjoiOzs7Ozs7O0FBR0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7Ozs7Ozs7O0FBZ0NBO0FBQ0EsTUFBTUEsc0JBQXNCLEdBQUcsSUFBL0I7QUFDQSxNQUFNQyxrQkFBa0IsR0FBRyxZQUEzQjtBQUVBLElBQUlDLEtBQUssR0FBRyxDQUFaOztBQUVl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U291cmNlSW5mbyB9IGZyb20gXCIuLi90eXBlc1wiXHJcbmltcG9ydCB0eXBlIHsgUmVnRXhwRmlsdGVyQ2hhbmdlIH0gZnJvbSBcIkBhdG9tLWlkZS1jb21tdW5pdHkvbnVjbGlkZS1jb21tb25zLXVpL1JlZ0V4cEZpbHRlclwiXHJcblxyXG5pbXBvcnQgeyBtYWNyb3Rhc2sgfSBmcm9tIFwiQGF0b20taWRlLWNvbW11bml0eS9udWNsaWRlLWNvbW1vbnMvb2JzZXJ2YWJsZVwiXHJcbmltcG9ydCBVbml2ZXJzYWxEaXNwb3NhYmxlIGZyb20gXCJAYXRvbS1pZGUtY29tbXVuaXR5L251Y2xpZGUtY29tbW9ucy9Vbml2ZXJzYWxEaXNwb3NhYmxlXCJcclxuaW1wb3J0ICogYXMgUmVhY3QgZnJvbSBcInJlYWN0XCJcclxuaW1wb3J0IHsgT2JzZXJ2YWJsZSB9IGZyb20gXCJyeGpzLWNvbXBhdC9idW5kbGVzL3J4anMtY29tcGF0LnVtZC5taW4uanNcIlxyXG5pbXBvcnQgRmlsdGVyUmVtaW5kZXIgZnJvbSBcIkBhdG9tLWlkZS1jb21tdW5pdHkvbnVjbGlkZS1jb21tb25zLXVpL0ZpbHRlclJlbWluZGVyXCJcclxuaW1wb3J0IE91dHB1dFRhYmxlIGZyb20gXCIuL091dHB1dFRhYmxlXCJcclxuaW1wb3J0IENvbnNvbGVIZWFkZXIgZnJvbSBcIi4vQ29uc29sZUhlYWRlclwiXHJcbmltcG9ydCBJbnB1dEFyZWEgZnJvbSBcIi4vSW5wdXRBcmVhXCJcclxuaW1wb3J0IFByb21wdEJ1dHRvbiBmcm9tIFwiLi9Qcm9tcHRCdXR0b25cIlxyXG5pbXBvcnQgTmV3TWVzc2FnZXNOb3RpZmljYXRpb24gZnJvbSBcIi4vTmV3TWVzc2FnZXNOb3RpZmljYXRpb25cIlxyXG5pbXBvcnQgaW52YXJpYW50IGZyb20gXCJhc3NlcnRcIlxyXG5pbXBvcnQgbnVsbHRocm93cyBmcm9tIFwibnVsbHRocm93c1wiXHJcbmltcG9ydCBzaGFsbG93RXF1YWwgZnJvbSBcInNoYWxsb3dlcXVhbFwiXHJcbmltcG9ydCByZWNvcmRzQ2hhbmdlZCBmcm9tIFwiLi4vcmVjb3Jkc0NoYW5nZWRcIlxyXG5pbXBvcnQgU3R5bGVTaGVldCBmcm9tIFwiQGF0b20taWRlLWNvbW11bml0eS9udWNsaWRlLWNvbW1vbnMtdWkvU3R5bGVTaGVldFwiXHJcblxyXG50eXBlIFByb3BzID0ge1xyXG4gIHJlY29yZHM6IEFycmF5PFJlY29yZD4sXHJcbiAgaGlzdG9yeTogQXJyYXk8c3RyaW5nPixcclxuICBjbGVhclJlY29yZHM6ICgpID0+IHZvaWQsXHJcbiAgY3JlYXRlUGFzdGU6ID8oKSA9PiBQcm9taXNlPHZvaWQ+LFxyXG4gIHdhdGNoRWRpdG9yOiA/YXRvbSRBdXRvY29tcGxldGVXYXRjaEVkaXRvcixcclxuICBleGVjdXRlOiAoY29kZTogc3RyaW5nKSA9PiB2b2lkLFxyXG4gIGN1cnJlbnRFeGVjdXRvcjogP0V4ZWN1dG9yLFxyXG4gIGV4ZWN1dG9yczogTWFwPHN0cmluZywgRXhlY3V0b3I+LFxyXG4gIGludmFsaWRGaWx0ZXJJbnB1dDogYm9vbGVhbixcclxuICBlbmFibGVSZWdFeHBGaWx0ZXI6IGJvb2xlYW4sXHJcbiAgc2VsZWN0ZWRTb3VyY2VJZHM6IEFycmF5PHN0cmluZz4sXHJcbiAgc2VsZWN0RXhlY3V0b3I6IChleGVjdXRvcklkOiBzdHJpbmcpID0+IHZvaWQsXHJcbiAgc2VsZWN0U291cmNlczogKHNvdXJjZUlkczogQXJyYXk8c3RyaW5nPikgPT4gdm9pZCxcclxuICBzb3VyY2VzOiBBcnJheTxTb3VyY2U+LFxyXG4gIHVwZGF0ZUZpbHRlcjogKGNoYW5nZTogUmVnRXhwRmlsdGVyQ2hhbmdlKSA9PiB2b2lkLFxyXG4gIGdldFByb3ZpZGVyOiAoaWQ6IHN0cmluZykgPT4gP1NvdXJjZUluZm8sXHJcbiAgZmlsdGVyZWRSZWNvcmRDb3VudDogbnVtYmVyLFxyXG4gIGZpbHRlclRleHQ6IHN0cmluZyxcclxuICByZXNldEFsbEZpbHRlcnM6ICgpID0+IHZvaWQsXHJcbiAgZm9udFNpemU6IG51bWJlcixcclxuICBzZWxlY3RlZFNldmVyaXRpZXM6IFNldDxTZXZlcml0eT4sXHJcbiAgdG9nZ2xlU2V2ZXJpdHk6IChzZXZlcml0eTogU2V2ZXJpdHkpID0+IHZvaWQsXHJcbn1cclxuXHJcbnR5cGUgU3RhdGUgPSB7XHJcbiAgdW5zZWVuTWVzc2FnZXM6IGJvb2xlYW4sXHJcbiAgc2NvcGVOYW1lOiBzdHJpbmcsXHJcbn1cclxuXHJcbi8vIE1heGltdW0gdGltZSAobXMpIGZvciB0aGUgY29uc29sZSB0byB0cnkgc2Nyb2xsaW5nIHRvIHRoZSBib3R0b20uXHJcbmNvbnN0IE1BWElNVU1fU0NST0xMSU5HX1RJTUUgPSAzMDAwXHJcbmNvbnN0IERFRkFVTFRfU0NPUEVfTkFNRSA9IFwidGV4dC5wbGFpblwiXHJcblxyXG5sZXQgY291bnQgPSAwXHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBDb25zb2xlVmlldyBleHRlbmRzIFJlYWN0LkNvbXBvbmVudDxQcm9wcywgU3RhdGU+IHtcclxuICBfY29uc29sZVNjcm9sbFBhbmVFbDogP0hUTUxEaXZFbGVtZW50XHJcbiAgX2NvbnNvbGVIZWFkZXJDb21wb25lbnQ6ID9Db25zb2xlSGVhZGVyXHJcbiAgX2Rpc3Bvc2FibGVzOiBVbml2ZXJzYWxEaXNwb3NhYmxlXHJcbiAgX2V4ZWN1dG9yU2NvcGVEaXNwb3NhYmxlczogVW5pdmVyc2FsRGlzcG9zYWJsZVxyXG4gIF9pc1Njcm9sbGVkTmVhckJvdHRvbTogYm9vbGVhblxyXG4gIF9pZDogbnVtYmVyXHJcbiAgX2lucHV0QXJlYTogP0lucHV0QXJlYVxyXG5cclxuICAvLyBVc2VkIHdoZW4gX3Njcm9sbFRvQm90dG9tIGlzIGNhbGxlZC4gVGhlIGNvbnNvbGUgb3B0aW1pemVzIG1lc3NhZ2UgbG9hZGluZ1xyXG4gIC8vIHNvIHNjcm9sbGluZyB0byB0aGUgYm90dG9tIG9uY2UgZG9lc24ndCBhbHdheXMgc2Nyb2xsIHRvIHRoZSBib3R0b20gc2luY2VcclxuICAvLyBtb3JlIG1lc3NhZ2VzIGNhbiBiZSBsb2FkZWQgYWZ0ZXIuXHJcbiAgX2NvbnRpbnVvdXNseVNjcm9sbFRvQm90dG9tOiBib29sZWFuXHJcbiAgX3Njcm9sbGluZ1Rocm90dGxlOiA/cnhqcyRTdWJzY3JpcHRpb25cclxuXHJcbiAgX291dHB1dFRhYmxlOiA/T3V0cHV0VGFibGVcclxuXHJcbiAgY29uc3RydWN0b3IocHJvcHM6IFByb3BzKSB7XHJcbiAgICBzdXBlcihwcm9wcylcclxuICAgIHRoaXMuc3RhdGUgPSB7XHJcbiAgICAgIHVuc2Vlbk1lc3NhZ2VzOiBmYWxzZSxcclxuICAgICAgc2NvcGVOYW1lOiBERUZBVUxUX1NDT1BFX05BTUUsXHJcbiAgICB9XHJcbiAgICB0aGlzLl9kaXNwb3NhYmxlcyA9IG5ldyBVbml2ZXJzYWxEaXNwb3NhYmxlKClcclxuICAgIHRoaXMuX2V4ZWN1dG9yU2NvcGVEaXNwb3NhYmxlcyA9IG5ldyBVbml2ZXJzYWxEaXNwb3NhYmxlKClcclxuICAgIHRoaXMuX2lzU2Nyb2xsZWROZWFyQm90dG9tID0gdHJ1ZVxyXG4gICAgdGhpcy5fY29udGludW91c2x5U2Nyb2xsVG9Cb3R0b20gPSBmYWxzZVxyXG4gICAgdGhpcy5faWQgPSBjb3VudCsrXHJcbiAgfVxyXG5cclxuICBjb21wb25lbnREaWRNb3VudCgpOiB2b2lkIHtcclxuICAgIHRoaXMuX2Rpc3Bvc2FibGVzLmFkZChcclxuICAgICAgLy8gV2FpdCBmb3IgYDxPdXRwdXRUYWJsZSAvPmAgdG8gcmVuZGVyIGl0c2VsZiB2aWEgcmVhY3QtdmlydHVhbGl6ZWQgYmVmb3JlIHNjcm9sbGluZyBhbmRcclxuICAgICAgLy8gcmUtbWVhc3VyaW5nOyBPdGhlcndpc2UsIHRoZSBzY3JvbGxlZCBsb2NhdGlvbiB3aWxsIGJlIGluYWNjdXJhdGUsIHByZXZlbnRpbmcgdGhlIENvbnNvbGVcclxuICAgICAgLy8gZnJvbSBhdXRvLXNjcm9sbGluZy5cclxuICAgICAgbWFjcm90YXNrLnN1YnNjcmliZSgoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5fc3RhcnRTY3JvbGxUb0JvdHRvbSgpXHJcbiAgICAgIH0pLFxyXG4gICAgICAoKSA9PiB7XHJcbiAgICAgICAgaWYgKHRoaXMuX3Njcm9sbGluZ1Rocm90dGxlICE9IG51bGwpIHtcclxuICAgICAgICAgIHRoaXMuX3Njcm9sbGluZ1Rocm90dGxlLnVuc3Vic2NyaWJlKClcclxuICAgICAgICB9XHJcbiAgICAgIH0sXHJcbiAgICAgIGF0b20uY29tbWFuZHMuYWRkKFwiYXRvbS13b3Jrc3BhY2VcIiwge1xyXG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBudWNsaWRlLWludGVybmFsL2F0b20tYXBpc1xyXG4gICAgICAgIFwiYXRvbS1pZGUtY29uc29sZTpmb2N1cy1jb25zb2xlLXByb21wdFwiOiAoKSA9PiB7XHJcbiAgICAgICAgICBpZiAodGhpcy5faW5wdXRBcmVhICE9IG51bGwpIHtcclxuICAgICAgICAgICAgdGhpcy5faW5wdXRBcmVhLmZvY3VzKClcclxuICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG4gICAgICB9KSxcclxuICAgICAgYXRvbS5jb21tYW5kcy5hZGQoXCJhdG9tLXdvcmtzcGFjZVwiLCB7XHJcbiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG51Y2xpZGUtaW50ZXJuYWwvYXRvbS1hcGlzXHJcbiAgICAgICAgXCJhdG9tLWlkZS1jb25zb2xlOnNjcm9sbC10by1ib3R0b21cIjogKCkgPT4ge1xyXG4gICAgICAgICAgdGhpcy5fc2Nyb2xsVG9Cb3R0b20oKVxyXG4gICAgICAgIH0sXHJcbiAgICAgIH0pLFxyXG4gICAgICBhdG9tLmNvbW1hbmRzLmFkZChudWxsdGhyb3dzKHRoaXMuX2NvbnNvbGVTY3JvbGxQYW5lRWwpLCBcImF0b20taWRlOmZpbHRlclwiLCAoKSA9PiB0aGlzLl9mb2N1c0ZpbHRlcigpKVxyXG4gICAgKVxyXG4gIH1cclxuXHJcbiAgY29tcG9uZW50V2lsbFVubW91bnQoKTogdm9pZCB7XHJcbiAgICB0aGlzLl9kaXNwb3NhYmxlcy5kaXNwb3NlKClcclxuICAgIHRoaXMuX2V4ZWN1dG9yU2NvcGVEaXNwb3NhYmxlcy5kaXNwb3NlKClcclxuICB9XHJcblxyXG4gIGNvbXBvbmVudERpZFVwZGF0ZShwcmV2UHJvcHM6IFByb3BzKTogdm9pZCB7XHJcbiAgICAvLyBJZiByZWNvcmRzIGFyZSBhZGRlZCB3aGlsZSB3ZSdyZSBzY3JvbGxlZCB0byB0aGUgYm90dG9tIChvciB2ZXJ5IHZlcnkgY2xvc2UsIGF0IGxlYXN0KSxcclxuICAgIC8vIGF1dG9tYXRpY2FsbHkgc2Nyb2xsLlxyXG4gICAgaWYgKHRoaXMuX2lzU2Nyb2xsZWROZWFyQm90dG9tICYmIHJlY29yZHNDaGFuZ2VkKHByZXZQcm9wcy5yZWNvcmRzLCB0aGlzLnByb3BzLnJlY29yZHMpKSB7XHJcbiAgICAgIHRoaXMuX3N0YXJ0U2Nyb2xsVG9Cb3R0b20oKVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgX2ZvY3VzRmlsdGVyKCk6IHZvaWQge1xyXG4gICAgaWYgKHRoaXMuX2NvbnNvbGVIZWFkZXJDb21wb25lbnQgIT0gbnVsbCkge1xyXG4gICAgICB0aGlzLl9jb25zb2xlSGVhZGVyQ29tcG9uZW50LmZvY3VzRmlsdGVyKClcclxuICAgIH1cclxuICB9XHJcblxyXG4gIF9yZW5kZXJQcm9tcHRCdXR0b24oKTogUmVhY3QuRWxlbWVudDxhbnk+IHtcclxuICAgIGludmFyaWFudCh0aGlzLnByb3BzLmN1cnJlbnRFeGVjdXRvciAhPSBudWxsKVxyXG4gICAgY29uc3QgeyBjdXJyZW50RXhlY3V0b3IgfSA9IHRoaXMucHJvcHNcclxuICAgIGNvbnN0IG9wdGlvbnMgPSBBcnJheS5mcm9tKHRoaXMucHJvcHMuZXhlY3V0b3JzLnZhbHVlcygpKS5tYXAoKGV4ZWN1dG9yKSA9PiAoe1xyXG4gICAgICBpZDogZXhlY3V0b3IuaWQsXHJcbiAgICAgIGxhYmVsOiBleGVjdXRvci5uYW1lLFxyXG4gICAgfSkpXHJcbiAgICByZXR1cm4gKFxyXG4gICAgICA8UHJvbXB0QnV0dG9uXHJcbiAgICAgICAgdmFsdWU9e2N1cnJlbnRFeGVjdXRvci5pZH1cclxuICAgICAgICBvbkNoYW5nZT17dGhpcy5wcm9wcy5zZWxlY3RFeGVjdXRvcn1cclxuICAgICAgICBvcHRpb25zPXtvcHRpb25zfVxyXG4gICAgICAgIGNoaWxkcmVuPXtjdXJyZW50RXhlY3V0b3IubmFtZX1cclxuICAgICAgLz5cclxuICAgIClcclxuICB9XHJcblxyXG4gIF9pc1Njcm9sbGVkVG9Cb3R0b20ob2Zmc2V0SGVpZ2h0OiBudW1iZXIsIHNjcm9sbEhlaWdodDogbnVtYmVyLCBzY3JvbGxUb3A6IG51bWJlcik6IGJvb2xlYW4ge1xyXG4gICAgcmV0dXJuIHNjcm9sbEhlaWdodCAtIChvZmZzZXRIZWlnaHQgKyBzY3JvbGxUb3ApIDwgNVxyXG4gIH1cclxuXHJcbiAgVU5TQUZFX2NvbXBvbmVudFdpbGxSZWNlaXZlUHJvcHMobmV4dFByb3BzOiBQcm9wcyk6IHZvaWQge1xyXG4gICAgLy8gSWYgdGhlIG1lc3NhZ2VzIHdlcmUgY2xlYXJlZCwgaGlkZSB0aGUgbm90aWZpY2F0aW9uLlxyXG4gICAgaWYgKG5leHRQcm9wcy5yZWNvcmRzLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICB0aGlzLl9pc1Njcm9sbGVkTmVhckJvdHRvbSA9IHRydWVcclxuICAgICAgdGhpcy5zZXRTdGF0ZSh7IHVuc2Vlbk1lc3NhZ2VzOiBmYWxzZSB9KVxyXG4gICAgfSBlbHNlIGlmIChcclxuICAgICAgLy8gSWYgd2UgcmVjZWl2ZSBuZXcgbWVzc2FnZXMgYWZ0ZXIgd2UndmUgc2Nyb2xsZWQgYXdheSBmcm9tIHRoZSBib3R0b20sIHNob3cgdGhlIFwibmV3XHJcbiAgICAgIC8vIG1lc3NhZ2VzXCIgbm90aWZpY2F0aW9uLlxyXG4gICAgICAhdGhpcy5faXNTY3JvbGxlZE5lYXJCb3R0b20gJiZcclxuICAgICAgcmVjb3Jkc0NoYW5nZWQodGhpcy5wcm9wcy5yZWNvcmRzLCBuZXh0UHJvcHMucmVjb3JkcylcclxuICAgICkge1xyXG4gICAgICB0aGlzLnNldFN0YXRlKHsgdW5zZWVuTWVzc2FnZXM6IHRydWUgfSlcclxuICAgIH1cclxuXHJcbiAgICB0aGlzLl9leGVjdXRvclNjb3BlRGlzcG9zYWJsZXMuZGlzcG9zZSgpXHJcbiAgICB0aGlzLl9leGVjdXRvclNjb3BlRGlzcG9zYWJsZXMgPSBuZXcgVW5pdmVyc2FsRGlzcG9zYWJsZSgpXHJcbiAgICBmb3IgKGNvbnN0IGV4ZWN1dG9yIG9mIG5leHRQcm9wcy5leGVjdXRvcnMudmFsdWVzKCkpIHtcclxuICAgICAgaWYgKGV4ZWN1dG9yICE9IG51bGwgJiYgZXhlY3V0b3Iub25EaWRDaGFuZ2VTY29wZU5hbWUgIT0gbnVsbCkge1xyXG4gICAgICAgIHRoaXMuX2V4ZWN1dG9yU2NvcGVEaXNwb3NhYmxlcy5hZGQoXHJcbiAgICAgICAgICBleGVjdXRvci5vbkRpZENoYW5nZVNjb3BlTmFtZSgoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHNjb3BlTmFtZSA9IGV4ZWN1dG9yLnNjb3BlTmFtZSgpXHJcbiAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoe1xyXG4gICAgICAgICAgICAgIHNjb3BlTmFtZSxcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgIH0pXHJcbiAgICAgICAgKVxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBzaG91bGRDb21wb25lbnRVcGRhdGUobmV4dFByb3BzOiBQcm9wcywgbmV4dFN0YXRlOiBTdGF0ZSk6IGJvb2xlYW4ge1xyXG4gICAgcmV0dXJuICFzaGFsbG93RXF1YWwodGhpcy5wcm9wcywgbmV4dFByb3BzKSB8fCAhc2hhbGxvd0VxdWFsKHRoaXMuc3RhdGUsIG5leHRTdGF0ZSlcclxuICB9XHJcblxyXG4gIF9nZXRFeGVjdXRvciA9IChpZDogc3RyaW5nKTogP0V4ZWN1dG9yID0+IHtcclxuICAgIHJldHVybiB0aGlzLnByb3BzLmV4ZWN1dG9ycy5nZXQoaWQpXHJcbiAgfVxyXG5cclxuICBfZ2V0UHJvdmlkZXIgPSAoaWQ6IHN0cmluZyk6ID9Tb3VyY2VJbmZvID0+IHtcclxuICAgIHJldHVybiB0aGlzLnByb3BzLmdldFByb3ZpZGVyKGlkKVxyXG4gIH1cclxuXHJcbiAgcmVuZGVyKCk6IFJlYWN0Lk5vZGUge1xyXG4gICAgcmV0dXJuIChcclxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJjb25zb2xlXCI+XHJcbiAgICAgICAgPFN0eWxlU2hlZXRcclxuICAgICAgICAgIHNvdXJjZVBhdGg9XCJjb25zb2xlLWZvbnQtc3R5bGVcIlxyXG4gICAgICAgICAgcHJpb3JpdHk9ey0xfVxyXG4gICAgICAgICAgY3NzPXtgXHJcbiAgICAgICAgICAgICNjb25zb2xlLWZvbnQtc2l6ZS0ke3RoaXMuX2lkfSB7XHJcbiAgICAgICAgICAgICAgZm9udC1zaXplOiAke3RoaXMucHJvcHMuZm9udFNpemV9cHg7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIGB9XHJcbiAgICAgICAgLz5cclxuICAgICAgICA8Q29uc29sZUhlYWRlclxyXG4gICAgICAgICAgY2xlYXI9e3RoaXMucHJvcHMuY2xlYXJSZWNvcmRzfVxyXG4gICAgICAgICAgY3JlYXRlUGFzdGU9e3RoaXMucHJvcHMuY3JlYXRlUGFzdGV9XHJcbiAgICAgICAgICBpbnZhbGlkRmlsdGVySW5wdXQ9e3RoaXMucHJvcHMuaW52YWxpZEZpbHRlcklucHV0fVxyXG4gICAgICAgICAgZW5hYmxlUmVnRXhwRmlsdGVyPXt0aGlzLnByb3BzLmVuYWJsZVJlZ0V4cEZpbHRlcn1cclxuICAgICAgICAgIGZpbHRlclRleHQ9e3RoaXMucHJvcHMuZmlsdGVyVGV4dH1cclxuICAgICAgICAgIHJlZj17KGNvbXBvbmVudCkgPT4gKHRoaXMuX2NvbnNvbGVIZWFkZXJDb21wb25lbnQgPSBjb21wb25lbnQpfVxyXG4gICAgICAgICAgc2VsZWN0ZWRTb3VyY2VJZHM9e3RoaXMucHJvcHMuc2VsZWN0ZWRTb3VyY2VJZHN9XHJcbiAgICAgICAgICBzb3VyY2VzPXt0aGlzLnByb3BzLnNvdXJjZXN9XHJcbiAgICAgICAgICBvbkZpbHRlckNoYW5nZT17dGhpcy5wcm9wcy51cGRhdGVGaWx0ZXJ9XHJcbiAgICAgICAgICBvblNlbGVjdGVkU291cmNlc0NoYW5nZT17dGhpcy5wcm9wcy5zZWxlY3RTb3VyY2VzfVxyXG4gICAgICAgICAgc2VsZWN0ZWRTZXZlcml0aWVzPXt0aGlzLnByb3BzLnNlbGVjdGVkU2V2ZXJpdGllc31cclxuICAgICAgICAgIHRvZ2dsZVNldmVyaXR5PXt0aGlzLnByb3BzLnRvZ2dsZVNldmVyaXR5fVxyXG4gICAgICAgIC8+XHJcbiAgICAgICAgey8qXHJcbiAgICAgICAgICBXZSBuZWVkIGFuIGV4dHJhIHdyYXBwZXIgZWxlbWVudCBoZXJlIGluIG9yZGVyIHRvIGhhdmUgdGhlIG5ldyBtZXNzYWdlcyBub3RpZmljYXRpb24gc3RpY2tcclxuICAgICAgICAgIHRvIHRoZSBib3R0b20gb2YgdGhlIHNjcm9sbGFibGUgYXJlYSAoYW5kIG5vdCBzY3JvbGwgd2l0aCBpdCkuXHJcblxyXG4gICAgICAgICAgY29uc29sZS1mb250LXNpemUgaXMgZGVmaW5lZCBpbiBtYWluLmpzIGFuZCB1cGRhdGVkIHZpYSBhIHVzZXIgc2V0dGluZ1xyXG4gICAgICAgICovfVxyXG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiY29uc29sZS1ib2R5XCIgaWQ9e1wiY29uc29sZS1mb250LXNpemUtXCIgKyB0aGlzLl9pZH0+XHJcbiAgICAgICAgICA8ZGl2XHJcbiAgICAgICAgICAgIGNsYXNzTmFtZT1cImNvbnNvbGUtc2Nyb2xsLXBhbmUtd3JhcHBlciBhdG9tLWlkZS1maWx0ZXJhYmxlXCJcclxuICAgICAgICAgICAgcmVmPXsoZWwpID0+ICh0aGlzLl9jb25zb2xlU2Nyb2xsUGFuZUVsID0gZWwpfVxyXG4gICAgICAgICAgPlxyXG4gICAgICAgICAgICA8RmlsdGVyUmVtaW5kZXJcclxuICAgICAgICAgICAgICBub3VuPVwibWVzc2FnZVwiXHJcbiAgICAgICAgICAgICAgbm91blBsdXJhbD1cIm1lc3NhZ2VzXCJcclxuICAgICAgICAgICAgICBmaWx0ZXJlZFJlY29yZENvdW50PXt0aGlzLnByb3BzLmZpbHRlcmVkUmVjb3JkQ291bnR9XHJcbiAgICAgICAgICAgICAgb25SZXNldD17dGhpcy5wcm9wcy5yZXNldEFsbEZpbHRlcnN9XHJcbiAgICAgICAgICAgIC8+XHJcbiAgICAgICAgICAgIDxPdXRwdXRUYWJsZVxyXG4gICAgICAgICAgICAgIC8vICRGbG93Rml4TWUoPj0wLjUzLjApIEZsb3cgc3VwcHJlc3NcclxuICAgICAgICAgICAgICByZWY9e3RoaXMuX2hhbmRsZU91dHB1dFRhYmxlfVxyXG4gICAgICAgICAgICAgIHJlY29yZHM9e3RoaXMucHJvcHMucmVjb3Jkc31cclxuICAgICAgICAgICAgICBzaG93U291cmNlTGFiZWxzPXt0aGlzLnByb3BzLnNlbGVjdGVkU291cmNlSWRzLmxlbmd0aCA+IDF9XHJcbiAgICAgICAgICAgICAgZm9udFNpemU9e3RoaXMucHJvcHMuZm9udFNpemV9XHJcbiAgICAgICAgICAgICAgZ2V0RXhlY3V0b3I9e3RoaXMuX2dldEV4ZWN1dG9yfVxyXG4gICAgICAgICAgICAgIGdldFByb3ZpZGVyPXt0aGlzLl9nZXRQcm92aWRlcn1cclxuICAgICAgICAgICAgICBvblNjcm9sbD17dGhpcy5faGFuZGxlU2Nyb2xsfVxyXG4gICAgICAgICAgICAgIHNob3VsZFNjcm9sbFRvQm90dG9tPXt0aGlzLl9zaG91bGRTY3JvbGxUb0JvdHRvbX1cclxuICAgICAgICAgICAgLz5cclxuICAgICAgICAgICAgPE5ld01lc3NhZ2VzTm90aWZpY2F0aW9uIHZpc2libGU9e3RoaXMuc3RhdGUudW5zZWVuTWVzc2FnZXN9IG9uQ2xpY2s9e3RoaXMuX3N0YXJ0U2Nyb2xsVG9Cb3R0b219IC8+XHJcbiAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgIHt0aGlzLl9yZW5kZXJQcm9tcHQoKX1cclxuICAgICAgICA8L2Rpdj5cclxuICAgICAgPC9kaXY+XHJcbiAgICApXHJcbiAgfVxyXG5cclxuICBfZ2V0TXVsdGlMaW5lVGlwKCk6IHN0cmluZyB7XHJcbiAgICBjb25zdCB7IGN1cnJlbnRFeGVjdXRvciB9ID0gdGhpcy5wcm9wc1xyXG4gICAgaWYgKGN1cnJlbnRFeGVjdXRvciA9PSBudWxsKSB7XHJcbiAgICAgIHJldHVybiBcIlwiXHJcbiAgICB9XHJcbiAgICBjb25zdCBrZXlDb21ibyA9XHJcbiAgICAgIHByb2Nlc3MucGxhdGZvcm0gPT09IFwiZGFyd2luXCJcclxuICAgICAgICA/IC8vIE9wdGlvbiArIEVudGVyIG9uIE1hY1xyXG4gICAgICAgICAgXCJcXHUyMzI1ICArIFxcdTIzQ0VcIlxyXG4gICAgICAgIDogLy8gU2hpZnQgKyBFbnRlciBvbiBXaW5kb3dzIGFuZCBMaW51eC5cclxuICAgICAgICAgIFwiU2hpZnQgKyBFbnRlclwiXHJcblxyXG4gICAgcmV0dXJuIGBUaXA6ICR7a2V5Q29tYm99IHRvIGluc2VydCBhIG5ld2xpbmVgXHJcbiAgfVxyXG5cclxuICBfcmVuZGVyUHJvbXB0KCk6ID9SZWFjdC5FbGVtZW50PGFueT4ge1xyXG4gICAgY29uc3QgeyBjdXJyZW50RXhlY3V0b3IgfSA9IHRoaXMucHJvcHNcclxuICAgIGlmIChjdXJyZW50RXhlY3V0b3IgPT0gbnVsbCkge1xyXG4gICAgICByZXR1cm5cclxuICAgIH1cclxuICAgIHJldHVybiAoXHJcbiAgICAgIDxkaXYgY2xhc3NOYW1lPVwiY29uc29sZS1wcm9tcHRcIj5cclxuICAgICAgICB7dGhpcy5fcmVuZGVyUHJvbXB0QnV0dG9uKCl9XHJcbiAgICAgICAgPElucHV0QXJlYVxyXG4gICAgICAgICAgcmVmPXsoY29tcG9uZW50OiA/SW5wdXRBcmVhKSA9PiAodGhpcy5faW5wdXRBcmVhID0gY29tcG9uZW50KX1cclxuICAgICAgICAgIHNjb3BlTmFtZT17dGhpcy5zdGF0ZS5zY29wZU5hbWV9XHJcbiAgICAgICAgICBmb250U2l6ZT17dGhpcy5wcm9wcy5mb250U2l6ZX1cclxuICAgICAgICAgIG9uU3VibWl0PXt0aGlzLl9leGVjdXRlUHJvbXB0fVxyXG4gICAgICAgICAgaGlzdG9yeT17dGhpcy5wcm9wcy5oaXN0b3J5fVxyXG4gICAgICAgICAgd2F0Y2hFZGl0b3I9e3RoaXMucHJvcHMud2F0Y2hFZGl0b3J9XHJcbiAgICAgICAgICBwbGFjZWhvbGRlclRleHQ9e3RoaXMuX2dldE11bHRpTGluZVRpcCgpfVxyXG4gICAgICAgIC8+XHJcbiAgICAgIDwvZGl2PlxyXG4gICAgKVxyXG4gIH1cclxuXHJcbiAgX2V4ZWN1dGVQcm9tcHQgPSAoY29kZTogc3RyaW5nKTogdm9pZCA9PiB7XHJcbiAgICB0aGlzLnByb3BzLmV4ZWN1dGUoY29kZSlcclxuICAgIC8vIE1ha2VzIHRoZSBjb25zb2xlIHRvIHNjcm9sbCB0byB0aGUgYm90dG9tLlxyXG4gICAgdGhpcy5faXNTY3JvbGxlZE5lYXJCb3R0b20gPSB0cnVlXHJcbiAgfVxyXG5cclxuICBfaGFuZGxlU2Nyb2xsID0gKG9mZnNldEhlaWdodDogbnVtYmVyLCBzY3JvbGxIZWlnaHQ6IG51bWJlciwgc2Nyb2xsVG9wOiBudW1iZXIpOiB2b2lkID0+IHtcclxuICAgIHRoaXMuX2hhbmRsZVNjcm9sbEVuZChvZmZzZXRIZWlnaHQsIHNjcm9sbEhlaWdodCwgc2Nyb2xsVG9wKVxyXG4gIH1cclxuXHJcbiAgX2hhbmRsZVNjcm9sbEVuZChvZmZzZXRIZWlnaHQ6IG51bWJlciwgc2Nyb2xsSGVpZ2h0OiBudW1iZXIsIHNjcm9sbFRvcDogbnVtYmVyKTogdm9pZCB7XHJcbiAgICBjb25zdCBpc1Njcm9sbGVkVG9Cb3R0b20gPSB0aGlzLl9pc1Njcm9sbGVkVG9Cb3R0b20ob2Zmc2V0SGVpZ2h0LCBzY3JvbGxIZWlnaHQsIHNjcm9sbFRvcClcclxuXHJcbiAgICB0aGlzLl9pc1Njcm9sbGVkTmVhckJvdHRvbSA9IGlzU2Nyb2xsZWRUb0JvdHRvbVxyXG4gICAgdGhpcy5fc3RvcFNjcm9sbFRvQm90dG9tKClcclxuICAgIHRoaXMuc2V0U3RhdGUoe1xyXG4gICAgICAvLyBUT0RPOiAod2Jpbm5zc21pdGgpIFQzMDc3MTQzNSB0aGlzIHNldFN0YXRlIGRlcGVuZHMgb24gY3VycmVudCBzdGF0ZVxyXG4gICAgICAvLyBhbmQgc2hvdWxkIHVzZSBhbiB1cGRhdGVyIGZ1bmN0aW9uIHJhdGhlciB0aGFuIGFuIG9iamVjdFxyXG4gICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgcmVhY3Qvbm8tYWNjZXNzLXN0YXRlLWluLXNldHN0YXRlXHJcbiAgICAgIHVuc2Vlbk1lc3NhZ2VzOiB0aGlzLnN0YXRlLnVuc2Vlbk1lc3NhZ2VzICYmICF0aGlzLl9pc1Njcm9sbGVkTmVhckJvdHRvbSxcclxuICAgIH0pXHJcbiAgfVxyXG5cclxuICBfaGFuZGxlT3V0cHV0VGFibGUgPSAocmVmOiBPdXRwdXRUYWJsZSk6IHZvaWQgPT4ge1xyXG4gICAgdGhpcy5fb3V0cHV0VGFibGUgPSByZWZcclxuICB9XHJcblxyXG4gIF9zY3JvbGxUb0JvdHRvbSA9ICgpOiB2b2lkID0+IHtcclxuICAgIGlmICghdGhpcy5fb3V0cHV0VGFibGUpIHtcclxuICAgICAgcmV0dXJuXHJcbiAgICB9XHJcblxyXG4gICAgdGhpcy5fb3V0cHV0VGFibGUuc2Nyb2xsVG9Cb3R0b20oKVxyXG5cclxuICAgIHRoaXMuc2V0U3RhdGUoeyB1bnNlZW5NZXNzYWdlczogZmFsc2UgfSlcclxuICB9XHJcblxyXG4gIF9zdGFydFNjcm9sbFRvQm90dG9tID0gKCk6IHZvaWQgPT4ge1xyXG4gICAgaWYgKCF0aGlzLl9jb250aW51b3VzbHlTY3JvbGxUb0JvdHRvbSkge1xyXG4gICAgICB0aGlzLl9jb250aW51b3VzbHlTY3JvbGxUb0JvdHRvbSA9IHRydWVcclxuXHJcbiAgICAgIHRoaXMuX3Njcm9sbGluZ1Rocm90dGxlID0gT2JzZXJ2YWJsZS50aW1lcihNQVhJTVVNX1NDUk9MTElOR19USU1FKS5zdWJzY3JpYmUoKCkgPT4ge1xyXG4gICAgICAgIHRoaXMuX3N0b3BTY3JvbGxUb0JvdHRvbSgpXHJcbiAgICAgIH0pXHJcbiAgICB9XHJcblxyXG4gICAgdGhpcy5fc2Nyb2xsVG9Cb3R0b20oKVxyXG4gIH1cclxuXHJcbiAgX3N0b3BTY3JvbGxUb0JvdHRvbSA9ICgpOiB2b2lkID0+IHtcclxuICAgIHRoaXMuX2NvbnRpbnVvdXNseVNjcm9sbFRvQm90dG9tID0gZmFsc2VcclxuICAgIGlmICh0aGlzLl9zY3JvbGxpbmdUaHJvdHRsZSAhPSBudWxsKSB7XHJcbiAgICAgIHRoaXMuX3Njcm9sbGluZ1Rocm90dGxlLnVuc3Vic2NyaWJlKClcclxuICAgIH1cclxuICB9XHJcblxyXG4gIF9zaG91bGRTY3JvbGxUb0JvdHRvbSA9ICgpOiBib29sZWFuID0+IHtcclxuICAgIHJldHVybiB0aGlzLl9pc1Njcm9sbGVkTmVhckJvdHRvbSB8fCB0aGlzLl9jb250aW51b3VzbHlTY3JvbGxUb0JvdHRvbVxyXG4gIH1cclxufVxyXG4iXX0=